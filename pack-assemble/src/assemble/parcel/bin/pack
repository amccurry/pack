#!/bin/bash
set -e
CMD=$1
case $CMD in
  (create)
    exec -a pack-cli sudo \
    curl --unix-socket /var/run/docker/plugins/pack.sock \
         -H "Content-Type: application/json" \
         -d "{\"Name\": \"$2\"}" \
         -X POST http:/VolumeDriver.Create
    ;;
  (remove)
    exec -a pack-cli sudo \
    curl --unix-socket /var/run/docker/plugins/pack.sock \
         -H "Content-Type: application/json" \
         -d "{\"Name\": \"$2\"}" \
         -X POST http:/VolumeDriver.Remove
    ;;
  (list)
    exec -a pack-cli sudo \
    curl --unix-socket /var/run/docker/plugins/pack.sock \
         -H "Content-Type: application/json" \
         -d "{}" \
         -X POST http:/VolumeDriver.List
    ;;
  (*)
    echo "Don't understand [$CMD]"
    ;;
esac
